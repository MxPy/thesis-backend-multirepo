workspace {
    model {
        user = person "Urzytkownik" "Końcowy użytkownik systemu monitorowania zdrowia"
        admin = person "Administrator" "Osoba zarządzająca systemem i monitorująca jego działanie"
            
        softwareSystem = softwareSystem "Część serwerowa" "Centralna część systemu odpowiedzialna za przetwarzanie i przechowywanie danych"{
            group BramaSystemu {
                api = container "BramaAPI" "Główny punkt dostępowy do systemu obsługujący żądania od klientów"
                aa = container "SerwisAutoryzacjiIUwierzytelnianiaUrzytkowników" "Komponent odpowiedzialny za bezpieczeństwo i zarządzanie dostępem"
                api -> aa "Wysyła zapytanie o autoryzacje i uwierzytelnienie użytkownika"
                api -> aa "Przekazuje zapytania i odpowiedzi o dane kont użytkowników"
            }
            
            group SystemMonitorowaniaZdrowia {
                dataPy = container "SerwisPrzetwarzaniaDanychDlaTreningów" "Serwis analizujący i przetwarzający dane zdrowotne użytkowników"
                dataNode = container "SerwisZarządzaniaUrzytkownikami" "Serwis zarządzający profilami i ustawieniami użytkowników"
                
                api -> dataPy "Przekazuje zapytania i odpowiedzi o dane zdrowotne użytkowników"
                api -> dataNode "Przekazuje zapytania  i odpowiedzi o dane zdrowotne użytkowników"
            }

            group SystemPrzechowywaniaDanych {
                sqlWraper = container "BramkaDostępowaRelacyjnejBazyDanych" "Interfejs dostępu do bazy SQL"
                timeWrpaer = container "BramkaDostępowaRelacyjnejBazyDanychSzeregówCzasowych" "Interfejs dostępu do bazy szeregów czasowych"
                sql = container "BazaDanychRelacyjna" "Główna baza danych przechowująca strukturalne dane użytkowników"{
                    tags "Database"
                }
                nosql = container "BazaDanychNieRelacyjna" "Baza danych do przechowywania danych sesji i cachowania"{
                    tags "Database"
                }
                time = container "BazaDanychRelacyjnaSzeregówCzasowych" "Baza danych do przechowywania historycznych danych zdrowotnych"{
                    tags "Database"
                }
                avatars = container "BazaDanychObiektówAwatarówUrzytkowników" "Magazyn awatarów użytkowników"{
                    tags "Database"
                }
                images = container "BazaDanychObiektówObraków" "Magazyn zdjęć i grafik systemu"{
                    tags "Database"
                }
                ota = container "BazaDanychObiektówOprogramowaniaOpaski" "Repozytorium aktualizacji firmware opaski"{
                    tags "Database"
                }
                graphs = container "BazaDanychObiektówDanychDoGrafówDanychZdrowotnych" "Baza do przechowywania powiązań między danymi zdrowotnymi"{
                    tags "Database"
                }
                
                api -> avatars "Zapisuje awatary użytkowników"
                api -> images "Zapisuje obrazki użytkowników"
                api -> ota "Zapisuje nowe wersje oprogramowania opaski"
                aa -> nosql "Zapisuje i odczytuje informacje sesji użytkowników"
                
                aa -> sqlWraper "Przesyła i odbiera dane kont użytkowników"
                dataPy -> sqlWraper "Przesyła i odbiera dane zdrowotne użytkowników"
                dataNode -> sqlWraper "Przesyła i odbiera dane zdrowotne użytkowników"
                
                dataPy -> timeWrpaer "Przesyła i odbiera szeregi czaowe danych zdrowotnych użytkowników"
                timeWrpaer -> time "Zapisuje i odczytuje szeregi czaowe danych zdrowotnych użytkowników"
                sqlWraper -> sql "Zapisuje i Odczytuje dane zdrowotne użytkowników"
                
                dataPy -> graphs "Przesyła i odbiera dane o grafach danych zdrowotnych użytkowników"
            }
            
            group BrokerWiadomości {
                queueAdmin = container "KolejkaInformacjiAdministracyjnych" "Kolejka do przesyłania powiadomień administracyjnych"{
                    tags "Database"
                }
                queueData = container "KolejkaInformacjiZdrowotnych" "Kolejka do przesyłania powiadomień o danych zdrowotnych"{
                    tags "Database"
                }
                queueAdmin -> api "Przesyła informacje administracyjne"
                queueData -> api "Przesyła informacje zdrowotne"
                
                dataPy -> queueAdmin "Przesyła informacje administracyjne"
                dataPy -> queueData "Przesyła informacje zdrowotne"
            } 
                
            group PanelAdministracyjny {
                adminPanel = container "PanelAdministracyjny" "Interfejs zarządzania systemem dla administratorów"
                
                admin -> adminPanel "Używa"
                adminPanel -> api "Wysyła zapytania o dane zdrowotne i kont użytkowników"
                adminPanel -> api "Wysyła nową wersje systemu opaski"
                api -> adminPanel "Przesyła powiadomienia o danych administracyjnych"
            }
        }
        
        bandSystem = softwareSystem "Opaska sportowa" "Urządzenie noszone zbierające dane biometryczne użytkownika"{
            group CzęśćSprzętowa {
                mcu = container "Mikrokontroler ESP32" "Główny procesor opaski odpowiedzialny za zbieranie i przetwarzanie danych"
                sensors = container "Czujniki" "Zestaw czujników do pomiaru parametrów zdrowotnych"
                card = container "Karta pamięci" "Pamięć do tymczasowego przechowywania danych"
            }
            group CzęśćOprogramowaniaSprzętowego {
                firmware = container "Oprogramowanie opaski" "System operacyjny i oprogramowanie sterujące opaską"
            }
            
            user -> bandSystem "Nosi"
            firmware -> mcu "Zarządza"
            mcu -> sensors "Jest połączony"
            firmware -> sensors "Odczytuje dane zdrowotne"
            firmware -> card "Zapisuje i odczytuje tymczasowe dane zdrowotne"
            mcu -> card "Jest połączony"
            ota -> bandSystem "Przesyła nową wersje oprogramowania"
        }
        
        appSystem = softwareSystem "Aplikacje mobilne" "Aplikacje na urządzenia mobilne do interakcji z systemem"{
            group AplikacjaIOS {
                iosApp = container "Aplikacja iOS" "Aplikacja mobilna dla systemu iOS"
                iosDb = container "Baza tymczasowych danych zdrowotnych iOS" "Lokalna baza danych na urządzeniach iOS"{
                    tags "Database"
                }
                
                user -> iosApp "Używa"
                iosApp -> iosDb "Zapisuje i odczytuje tymczasowe dane zdrowotne"
                bandSystem -> iosApp "Przesyła dane o statusie opaski oraz zdrowotne"
                iosApp -> bandSystem "Przesyła informacje o aktualizacji oprogramowania opaski"
            }
            group AplikacjaAndrioid {
                androidApp = container "Aplikacja Android" "Aplikacja mobilna dla systemu Android"
                androidDb = container "Baza tymczasowych danych zdrowotnych Android" "Lokalna baza danych na urządzeniach Android"{
                    tags "Database"
                }
                
                user -> androidApp "Używa"
                androidApp -> androidDb "Zapisuje i odczytuje tymczasowe dane zdrowotne"
                bandSystem -> androidApp "Przesyła dane o statusie opaski oraz zdrowotne"
                androidApp -> bandSystem "Przesyła informacje o aktualizacji oprogramowania opaski"
            }
            api -> appSystem "Przesyła powiadomienia o danych zdrowowtnych"
            appSystem -> api "Wysyła obrazki oraz awatary użytkowników"
            images -> appSystem "Pobiera obrazki użytkowników"
            avatars -> appSystem "Pobiera awatary użytkowników"
        }
    }

    views {
        styles {
            element "Database" {
                shape cylinder
            }
        }
        theme default
    }
}
